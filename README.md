
# Introduction 

Snyk plugin implemented to run in Eze.

# Build and Test

## Install Eze and all required tools Locally (via make)

```bash
make install
```

## Install Plugin Locally (Manual via pip)

```bash
rm dist/eze-snyk-plugin-*.tar.gz
python setup.py sdist
pip install dist/eze-snyk-plugin-*.tar.gz
```

## Test installed correctly

```bash
eze tools list
eze reporters list
```

## Run Units Test

```bash
pytest tests
```

### Run Units Test: How to update pytest snapshot tests

Out the box pytest's snapshot plugin is very easy to update, run this command to regenerate the fixtures after changes.

```bash
pytest tests --snapshot-update
```

_ps remember to always manually check the diff before committing updated snapshots!_

Of course it's your plugin so if you don't like snapshot testing (it is controversial) you don't need to include them!

We just find for complex HTML or console output, it's great at deterministic integration tests.

### Snapshot Test Fixtures

For those unfamiliar with snapshot testing, it's basically just a fixture framework for testing output against text blob
on the filesystem, with a easy mechanism to automatically update the blobs when the output changes.

It's popular in the js react world when dealing with large html output that's being generated by layered systems.

Due to the emergent and brittle nature of cli output, eze uses snapshot testing for integration testing between multiple components.

It uses pytest's plugin, which runs as part of the pytest runner

https://pypi.org/project/pytest-snapshot/


Advantages:

- fast to setup
- easy to update when things change
- excellent at testing emergent output with large inputs and human readable string outputs

Disadvantages:

- brittle
- smoke test

  _aka : fails don't mean something is broken, just something somewhere has changed_
- requires a human to review snapshot changes
- poor/inefficient at testing, small pure functions with small inputs and small or non-string typed outputs

### Snapshot fixture location

All files will be stored in here

```
tests/__snapshots__
```

# Contribute

See [CONTRIBUTING GUIDE](https://github.com/RiverSafeUK/eze-example-plugin/blob/main/CONTRIBUTING.md)